@model Pedido
<h2>Resumen del Pedido</h2>
<p><strong>Número de pedido:</strong> @Model.Id</p>
<p>Fecha del pedido: @Model.Fecha.ToString("dd/MM/yyyy")</p>
<table>
    <thead>
        <tr>
            <th>Producto</th>
            <th>Categoría</th>
            <th>Cantidad</th>
            <th>Precio Unitario</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.PedidoProductos)
        {
            <tr>
                <td>@item.Producto.Nombre</td>
                <td>@item.Producto.Categoria</td>
                <td>@item.Cantidad</td>
                <td>$@item.Producto.Precio</td>
                <td>$@(item.Producto.Precio * item.Cantidad)</td>
            </tr>
        }
    </tbody>
</table>
<p><strong>Estado del pedido:</strong> @Model.Estado</p>
<p><strong>Total del pedido:</strong> $@Model.PedidoProductos.Sum(p => p.Producto.Precio * p.Cantidad)</p>

@if (Model.Estado == "Entregado" && Model.ComentarioEnviado == false)
{
    <div class="comentario-section mt-4">
        <h3>¿Qué te pareció nuestro servicio?</h3>
        <form asp-action="GuardarComentario" asp-controller="Pedidos" method="post">
            <input type="hidden" name="pedidoId" value="@Model.Id" />
            <div class="form-group mb-3">
                <label>Calificación:</label>
                <div class="rating">
                    <input type="radio" id="star5" name="calificacion" value="5" /><label for="star5">★</label>
                    <input type="radio" id="star4" name="calificacion" value="4" /><label for="star4">★</label>
                    <input type="radio" id="star3" name="calificacion" value="3" /><label for="star3">★</label>
                    <input type="radio" id="star2" name="calificacion" value="2" /><label for="star2">★</label>
                    <input type="radio" id="star1" name="calificacion" value="1" /><label for="star1">★</label>
                </div>
            </div>
            <div class="form-group mb-3">
                <label for="comentario">Comentario (opcional):</label>
                <textarea class="form-control" id="comentario" name="comentario" rows="3" placeholder="Cuéntanos tu experiencia..."></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Enviar valoración</button>
        </form>
    </div>
    <style>
        .rating {
            display: flex;
            flex-direction: row-reverse;
            justify-content: flex-end;
        }

            .rating input {
                display: none;
            }

            .rating label {
                font-size: 30px;
                color: #ddd;
                cursor: pointer;
                margin: 0 5px;
            }

                .rating label:hover,
                .rating label:hover ~ label,
                .rating input:checked ~ label {
                    color: #ffc107;
                }
    </style>
}
else if (Model.ComentarioEnviado)
{
    <div class="mt-4 p-3 bg-light rounded">
        <h4>Tu valoración</h4>
        <div class="stars-display">
            @for (int i = 1; i <= 5; i++)
            {
                if (i <= Model.Calificacion)
                {
                    <span class="star filled">★</span>
                }
                else
                {
                    <span class="star">★</span>
                }
            }
        </div>
        @if (!string.IsNullOrEmpty(Model.Comentario))
        {
            <p class="mt-2"><strong>Tu comentario:</strong> @Model.Comentario</p>
        }
        <p class="text-muted">Gracias por tu valoración.</p>
    </div>
    <style>
        .stars-display {
            font-size: 24px;
        }

        .star {
            color: #ddd;
            margin-right: 5px;
        }

            .star.filled {
                color: #ffc107;
            }
    </style>
}