@model IEnumerable<Proyecto1_MZ_MJ.Models.Producto>

@{
    ViewData["Title"] = "Menú de Productos";
}

<h2>@ViewData["Title"]</h2>

<form asp-controller="Pedidos" asp-action="AgregarSeleccionados" method="post">
    @Html.AntiForgeryToken()
    <div>
        @for (int i = 0; i < Model.Count(); i++)
        {
            var producto = Model.ElementAt(i);
            <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                <input type="checkbox" name="seleccionados[@i].Seleccionado" value="true" />
                <input type="hidden" name="seleccionados[@i].ProductoId" value="@producto.Id" />
                <strong>@producto.Nombre</strong> - @producto.Categoria <br />
                Precio: $@producto.Precio <br />
                Cantidad:
                <input type="number" name="seleccionados[@i].Cantidad" value="1" min="1" style="width: 60px;" />
            </div>
        }
    </div>
@*     <button type="submit">Agregar Seleccionados al Pedido</button>
 *@   
@*     <button onclick="obtenerUbicacionYEnviar()">Agregar Seleccionados al Pedido</button>
 *@    
    <button class="btn btn-success" onclick="obtenerUbicacionYEnviar()">
        Agregar Seleccionados al Pedido
    </button>

    <script>
        function obtenerUbicacionYEnviar() {
            // Obtener los productos seleccionados del carrito
            const productosSeleccionados = obtenerProductosSeleccionados(); // Esta función debe existir y retornar los productos

            // Guardar los productos seleccionados en localStorage
            localStorage.setItem('cart', JSON.stringify(productosSeleccionados));

            // Mensaje opcional para confirmar que se agregaron al carrito
            alert('Productos agregados al carrito');

            // Redireccionar a la página de selección de punto de recolección
            window.location.href = '/Recoleccion/Seleccionar';
        }

    </script>

</form>
