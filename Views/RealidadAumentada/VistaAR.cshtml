@model Proyecto1_MZ_MJ.Models.Producto
@{
    ViewData["Title"] = "Realidad Aumentada - " + Model.Nombre;
    Layout = "_Layout";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
<script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

<style>
    .ar-container {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
    }

    .back-button {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 1000;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        cursor: pointer;
    }

    .product-info {
        position: absolute;
        bottom: 20px;
        left: 20px;
        z-index: 1000;
        background-color: rgba(0, 0, 0, 0.5);
        color: white;
        padding: 10px;
        border-radius: 10px;
        max-width: 300px;
    }

    .product-name {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .product-price {
        font-size: 16px;
    }

    /* Ocultar elementos de la interfaz de A-Frame */
    .a-enter-vr, .a-orientation-modal {
        display: none !important;
    }
</style>

<div class="ar-container">
    <button class="back-button" onclick="history.back()">
        <i class="fas fa-arrow-left"></i>
    </button>

    <div class="product-info">
        <div class="product-name">@Model.Nombre</div>
        <div class="product-price">Precio: $@Model.Precio</div>
    </div>

    <!-- Escena de A-Frame para AR -->
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <!-- Marcador por defecto (patrón Hiro) -->
        <a-marker preset="hiro">
            <!-- Cubo rojo 3D -->
            <a-box position="0 0.5 0" material="color: red;" scale="1 1 1" animation="property: rotation; to: 0 360 0; loop: true; dur: 5000; easing: linear;"></a-box>
        </a-marker>

        <!-- Cámara -->
        <a-entity camera></a-entity>
    </a-scene>
</div>

<script>
    // Solicitar permiso para la cámara al cargar la página
    document.addEventListener('DOMContentLoaded', function() {
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(function(stream) {
                // El permiso fue concedido
                stream.getTracks().forEach(track => track.stop());
            })
            .catch(function(err) {
                alert('Para experimentar la realidad aumentada, por favor permite el acceso a la cámara.');
            });
    });
</script>